# Migrating from 16.x.x

## Major changes

1. Refactors the v4 package types
2. Support for Asynchronous messages (fixes https://github.com/pact-foundation/pact-js/issues/1186)
3. Support for passing bodies back into the `executeTest` function for synchronous messages
4. Updated v3/v4 examples
   1. v3 graphql
   2. v4 graphql
   3. v4 messages (async)
   4. v4 multipart
5. Incorporates the GraphQL changes for V3 and V4 interfaces (fixes https://github.com/pact-foundation/pact-js/issues/1093)

Depends on upstream change here: https://github.com/pact-foundation/pact-js-core/pull/662

## Breaking changes

- `Pact` interface now aliased to `PactV4`, was `PactV2`
- previous `Pact` interface now renamed to `PactV2`
- `Matchers` interface now aliased to `MatchersV3`
- previous `Matchers` interface now renamed to `MatchersV2`
- Node versions `<20` are no longer supported, due to being eol. If you rely on Node 16-19, remain on pact-js v15, or update to use a supported node version.

### Notes for consuming packages

The breaking changes above, will be known to impact

- `jest-pact`
- `nestjs-pact`

## Basic migration

## Consumer

If you are relying on the `Pact` & `Matchers` interface, you will likely have to rename as `PactV2` / `MatchersV2` to preserve existing behaviour. Alternatively you can update your tests to use the new `PactV4` interface which is now aliased as `Pact`.

If you are relying on the `PactV4` interface, this can be updated to just `Pact` going forward, the same applies for `MatchersV3`, which can be updated to `Matchers`

- `Pact` -> `PactV2` (mandatory, if needing backwards compatibility with pact-js <16)
- `Matchers` -> `MatchersV2`  (mandatory, if needing backwards compatibility with pact-js <16)
- `PactV4` -> `Pact` (optional, but recommended)
- `MatchersV3` -> `Matchers` (optional, but recommended)

## Migrating PactV4/Matchers V3 code

if your import looks like

```js
import {
  SpecificationVersion,
  PactV4,
  LogLevel,
  MatchersV3,
} from '@pact-foundation/pact';
```

update to

```js
import {
  SpecificationVersion,
  Pact,
  LogLevel,
  Matchers,
} from '@pact-foundation/pact';
```


### Preserving existing behaviour

If your import looks like

```js
const { Pact, Matchers } = require('@pact-foundation/pact');
```

update to 



```js
const { PactV2: Pact, MatchersV2: Matchers } = require('@pact-foundation/pact');
```

otherwise if your import looks like this

```js
import {
  Pact,
  GraphQLInteraction,
  Matchers,
  LogLevel,
} from '@pact-foundation/pact';
```

update to

```js
import {
  PactV2 as Pact,
  GraphQLInteraction,
  MatchersV2 as Matchers,
  LogLevel,
} from '@pact-foundation/pact';
```